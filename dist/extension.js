(()=>{"use strict";var e={265:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){const t=new l.PackageJsonDiscoveryService,n=new u.SmartDetectionService(t);g=new h.PackageJsonStatusBar;const a=new c.CommandManager(e,t,n,g),o=new d.CommandProvider(a);e.subscriptions.push(i.commands.registerCommand("command-runner.addCommand",async()=>{const e=await i.window.showInputBox({prompt:"Enter command name",placeHolder:"e.g., start-dev"});if(!e)return;const t=await i.window.showInputBox({prompt:"Enter npm action",placeHolder:"e.g., npm run dev"});if(!t)return;const n=await i.window.showInputBox({prompt:"Enter a brief summary (optional)",placeHolder:"e.g., Starts the development server"});try{await a.addCommand({name:e,action:t,summary:n||""}),o.refresh()}catch(e){i.window.showErrorMessage(`Failed to add command: ${e instanceof Error?e.message:String(e)}`)}}),i.commands.registerCommand("command-runner.editCommand",async e=>{if(!e)return void i.window.showWarningMessage("Please select a command to edit.");const t=a.getCommands().find(t=>t.id===e.commandId);if(!t)return void i.window.showErrorMessage("Command not found.");const n=await i.window.showInputBox({prompt:"Edit command name",value:t.name});if(void 0===n)return;const s=await i.window.showInputBox({prompt:"Edit npm command",value:t.action});if(void 0===s)return;const r=await i.window.showInputBox({prompt:"Edit command summary",value:t.summary});void 0!==r&&(await a.updateCommand({...t,name:n,action:s,summary:r}),o.refresh())}),i.commands.registerCommand("command-runner.deleteCommand",async e=>{e?"Delete"===await i.window.showWarningMessage(`Are you sure you want to delete command '${e.label}'?`,{modal:!0},"Delete")&&(await a.deleteCommand(e.commandId),o.refresh()):i.window.showWarningMessage("Please select a command to delete.")}),i.commands.registerCommand("command-runner.runCommand",async e=>{if(!e)return void i.window.showWarningMessage("Please select a command to run.");const t=a.getCurrentPackageJson(),n=t?t.directory:void 0,o=`Command Runner (Temp): ${e.label}`,s=new i.Task({type:"shell",command:e.action},i.TaskScope.Workspace,o,"Command Runner",new i.ShellExecution(e.action,{cwd:n})),r=await i.tasks.executeTask(s),c=i.tasks.onDidEndTaskProcess(t=>{t.execution===r&&(0===t.exitCode?setTimeout(()=>{i.window.terminals.forEach(e=>{e.name===o&&e.dispose()})},2e3):i.window.showErrorMessage(`Command '${e.label}' failed with exit code ${t.exitCode}. Terminal kept open for review.`),c.dispose())})}),i.commands.registerCommand("command-runner.selectPackageJson",async()=>{const e=await a.getAvailablePackageJsons();if(0===e.length)return void i.window.showWarningMessage("No package.json files found in the workspace.");const t=await n.analyzeProjectContext(i.workspace.workspaceFolders?.[0]?.uri.fsPath||""),s=await p.PackageJsonSelector.selectPackageJson(e,t,{title:"Select Package.json for Commands",placeholder:"Choose which package.json to use for running commands"});s&&!Array.isArray(s)&&(await a.setCurrentPackageJson(s),o.refresh())}),i.commands.registerCommand("command-runner.showPackageJsonInfo",async()=>{const e=a.getCurrentPackageJson();e?await p.PackageJsonSelector.showPackageJsonInfo(e):i.window.showWarningMessage('No package.json selected. Use "Select Package.json" first.')}),i.commands.registerCommand("command-runner.refreshPackageJsons",async()=>{t.clearCache(),t.refreshWorkspaceRoots();const e=i.workspace.workspaceFolders;if(e&&e.length>0){const t=e[0].uri.fsPath,s=await n.shouldUseSpecificPackageJson(t);s&&(await a.setCurrentPackageJson(s),o.refresh())}}),i.commands.registerCommand("command-runner.addSuggestedCommand",async e=>{e&&e.name&&e.action&&(await a.addCommand({name:e.name,action:e.action,summary:e.summary||""}),o.refresh())})),i.window.registerTreeDataProvider("command-runner-sidebar",o),function(e,t,n,a){i.workspace.onDidChangeWorkspaceFolders(async()=>{e.refreshWorkspaceRoots();const o=i.workspace.workspaceFolders;if(o&&o.length>0){const e=o[0].uri.fsPath,s=await t.shouldUseSpecificPackageJson(e);s&&(await n.setCurrentPackageJson(s),a.refresh())}}),i.window.onDidChangeActiveTextEditor(async t=>{if(t&&t.document.fileName.endsWith(".json")&&"package.json"===m.basename(t.document.fileName)){const o=n.getCurrentPackageJson(),s=t.document.fileName;if(o?.path===s)return;const r=await e.parsePackageJson(s,0);r&&"Yes"===await i.window.showInformationMessage("Use this package.json for Command Runner?","Yes","No")&&(await n.setCurrentPackageJson(r),a.refresh())}})}(t,n,a,o),async function(e,t){const n=[{name:"npm install",action:"npm install",summary:"Install npm dependencies"},{name:"npm run dev",action:"npm run dev",summary:"Run development server"},{name:"npm run build",action:"npm run build",summary:"Build project for production"},{name:"npm test",action:"npm test",summary:"Run tests"}],a=e.getCommands();let o=!1;for(const t of n)a.some(e=>e.name===t.name&&e.action===t.action)||(await e.addCommand(t),o=!0);o&&t.refresh()}(a,o)},t.deactivate=function(){g.dispose()};const i=r(n(398)),c=n(746),d=n(944),l=n(626),u=n(842),p=n(955),m=r(n(928)),h=n(739);let g},398:e=>{e.exports=require("vscode")},626:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.PackageJsonDiscoveryService=void 0;const i=r(n(398)),c=r(n(896)),d=r(n(928));class l{constructor(){this.cache=new Map,this.workspaceRoots=[],this.initializeWorkspaceRoots(),this.setupWorkspaceWatcher()}initializeWorkspaceRoots(){this.workspaceRoots=i.workspace.workspaceFolders?.map(e=>e.uri.fsPath)||[]}setupWorkspaceWatcher(){const e=i.workspace.createFileSystemWatcher("**/package.json");e.onDidCreate(()=>this.clearCache()),e.onDidDelete(()=>this.clearCache()),e.onDidChange(()=>this.clearCache())}clearCache(){this.cache.clear()}async discoverPackageJsonFiles(e,t={}){const n={...l.DEFAULT_OPTIONS,...t},a=`${e}:${JSON.stringify(n)}`;if(n.cacheResults&&this.cache.has(a))return this.cache.get(a);const o=[],s=new Set;return await this.searchUpward(e,n.maxDepthUp,o,s,n),await this.searchDownward(e,n.maxDepthDown,o,s,n,0),this.calculateScores(o,e),o.sort((e,t)=>t.score-e.score),n.cacheResults&&this.cache.set(a,o),o}async searchUpward(e,t,n,a,o,s=0){if(s>t||a.has(e))return;a.add(e);const r=d.join(e,"package.json");if(await this.fileExists(r)){const e=await this.parsePackageJson(r,s);e&&n.push(e)}const i=d.dirname(e);i!==e&&await this.searchUpward(i,t,n,a,o,s+1)}async searchDownward(e,t,n,a,o,s){if(s>t||a.has(e))return;a.add(e);const r=d.join(e,"package.json");if(await this.fileExists(r)){const e=await this.parsePackageJson(r,s);e&&n.push(e)}try{const r=await c.promises.readdir(e,{withFileTypes:!0});for(const i of r){if(!i.isDirectory())continue;if(!o.includeNodeModules&&"node_modules"===i.name)continue;if(this.shouldSkipDirectory(i.name))continue;const r=d.join(e,i.name);await this.searchDownward(r,t,n,a,o,s+1)}}catch(e){}}async fileExists(e){try{return await c.promises.access(e,c.constants.F_OK),!0}catch{return!1}}shouldSkipDirectory(e){return e.startsWith(".")&&!e.startsWith("..")||[".git",".svn",".hg",".vscode",".idea","dist","build","out",".next",".nuxt","coverage",".nyc_output","tmp","temp","__pycache__",".pytest_cache"].includes(e)}async parsePackageJson(e,t){try{const n=await c.promises.readFile(e,"utf-8"),a=JSON.parse(n),o=d.dirname(e),s=this.workspaceRoots.includes(o),r=!!a.workspaces;return{path:e,directory:o,name:a.name,version:a.version,scripts:a.scripts||{},isWorkspaceRoot:s,isMonorepoRoot:r,workspaces:a.workspaces,distance:t,score:0}}catch(e){return null}}calculateScores(e,t){const n=e.some(e=>e.directory===t&&0===e.distance);for(const a of e){let e=0;e+=Math.max(0,100-10*a.distance),a.isWorkspaceRoot&&(e+=50),a.isMonorepoRoot&&(e+=30),a.scripts&&Object.keys(a.scripts).length>0&&(e+=20),a.scripts&&["start","dev","build","test","lint"].some(e=>a.scripts[e])&&(e+=15),a.directory===t&&(e+=25),n||1!==a.distance||(e+=40),a.score=e}}async getBestPackageJson(e,t){const n={...l.DEFAULT_OPTIONS,...t};let a=await this.discoverPackageJsonFiles(e,n);if(!a.some(t=>t.directory===e)&&n.maxDepthDown>0){const t=await this.discoverPackageJsonFiles(e,{...n,maxDepthUp:0,maxDepthDown:Math.min(n.maxDepthDown,2),cacheResults:!1});a.push(...t),this.calculateScores(a,e),a.sort((e,t)=>t.score-e.score)}return a.length>0?a[0]:null}async getWorkspacePackageJsonFiles(){const e=[];for(const t of this.workspaceRoots){const n=await this.discoverPackageJsonFiles(t,{maxDepthUp:0,maxDepthDown:10});e.push(...n)}return e.filter((e,t,n)=>n.findIndex(t=>t.path===e.path)===t).sort((e,t)=>t.score-e.score)}async findPackageJsonInDirectory(e){return this.discoverPackageJsonFiles(e,{maxDepthUp:0,maxDepthDown:1,cacheResults:!1})}async findNearestParentPackageJson(e){const t=await this.discoverPackageJsonFiles(e,{maxDepthUp:10,maxDepthDown:0,cacheResults:!1});return t.length>0?t.reduce((e,t)=>t.distance<e.distance?t:e):null}async findChildPackageJsonFiles(e,t=5){return this.discoverPackageJsonFiles(e,{maxDepthUp:0,maxDepthDown:t,cacheResults:!1})}async getPackageJsonByDistance(e,t=0,n=5){return(await this.discoverPackageJsonFiles(e)).filter(e=>e.distance>=t&&e.distance<=n)}isWithinWorkspace(e){return this.workspaceRoots.some(t=>e.startsWith(t)||t.startsWith(e))}getWorkspaceRoot(e){for(const t of this.workspaceRoots)if(e.startsWith(t))return t;return null}refreshWorkspaceRoots(){this.initializeWorkspaceRoots(),this.clearCache()}}t.PackageJsonDiscoveryService=l,l.DEFAULT_OPTIONS={maxDepthUp:10,maxDepthDown:5,includeNodeModules:!1,workspaceRootsOnly:!1,cacheResults:!0}},739:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.PackageJsonStatusBar=void 0;const i=r(n(398));t.PackageJsonStatusBar=class{constructor(){this._statusBarItem=i.window.createStatusBarItem(i.StatusBarAlignment.Left,100),this.updateStatus(null),this._statusBarItem.show()}updateStatus(e){e?this._statusBarItem.hide():(this._statusBarItem.text="$(warning) No package.json found",this._statusBarItem.tooltip="No package.json file could be automatically detected or selected.",this._statusBarItem.command="command-runner.selectPackageJson",this._statusBarItem.show())}dispose(){this._statusBarItem.dispose()}}},746:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CommandManager=void 0;const i=r(n(398));class c{constructor(e,t,n,a){this.currentPackageJson=null,this.context=e,this.discoveryService=t,this.smartDetectionService=n,this.packageJsonStatusBar=a,this.preferences=this.loadPreferences(),this.initializeCurrentPackageJson()}loadPreferences(){const e=this.context.globalState.get(c.PREFERENCES_KEY,{});return{...c.DEFAULT_PREFERENCES,...e}}async savePreferences(){await this.context.globalState.update(c.PREFERENCES_KEY,this.preferences)}getPreferences(){return{...this.preferences}}async updatePreferences(e){this.preferences={...this.preferences,...e},await this.savePreferences()}async addToHistory(e){const t=this.context.globalState.get(c.PACKAGE_HISTORY_KEY,[]).filter(t=>t!==e.path);t.unshift(e.path);const n=t.slice(0,10);await this.context.globalState.update(c.PACKAGE_HISTORY_KEY,n)}async getPackageJsonHistory(){const e=this.context.globalState.get(c.PACKAGE_HISTORY_KEY,[]),t=[];for(const n of e)try{const e=await this.discoveryService.parsePackageJson(n,0);e&&t.push(e)}catch{}return t}async initializeCurrentPackageJson(){const e=this.context.globalState.get(c.SELECTED_PACKAGE_KEY);if(e)try{const t=await this.discoveryService.parsePackageJson(e,0);if(t)return void(this.currentPackageJson=t)}catch{}await this.autoDetectPackageJson(),this.packageJsonStatusBar.updateStatus(this.currentPackageJson)}async autoDetectPackageJson(){const e=i.workspace.workspaceFolders;if(!e||0===e.length)return;const t=e[0].uri.fsPath,n=await this.smartDetectionService.shouldUseSpecificPackageJson(t);n&&(this.currentPackageJson=n,await this.saveCurrentPackageJson()),this.packageJsonStatusBar.updateStatus(this.currentPackageJson)}async saveCurrentPackageJson(){this.currentPackageJson&&await this.context.globalState.update(c.SELECTED_PACKAGE_KEY,this.currentPackageJson.path)}getCurrentPackageJson(){return this.currentPackageJson}async setCurrentPackageJson(e){this.currentPackageJson=e,await this.saveCurrentPackageJson(),this.packageJsonStatusBar.updateStatus(this.currentPackageJson),this.preferences.rememberLastSelection&&await this.addToHistory(e)}async getAvailablePackageJsons(){const e=i.workspace.workspaceFolders;if(!e||0===e.length)return[];const t=e[0].uri.fsPath;return await this.discoveryService.discoverPackageJsonFiles(t)}async getContextualRecommendations(){const e=i.workspace.workspaceFolders;if(!e||0===e.length)return[];const t=e[0].uri.fsPath;return await this.smartDetectionService.getContextualRecommendations(t)}getCommands(){return this.context.globalState.get(c.COMMANDS_KEY,[])}async addCommand(e){const t=this.getCommands(),n={...e,id:Date.now().toString(),packageJsonPath:this.currentPackageJson?.path};t.push(n),await this.saveCommands(t)}async updateCommand(e){let t=this.getCommands();const n=t.findIndex(t=>t.id===e.id);-1!==n&&(t[n]=e,await this.saveCommands(t))}async deleteCommand(e){let t=this.getCommands();t=t.filter(t=>t.id!==e),await this.saveCommands(t)}async saveCommands(e){await this.context.globalState.update(c.COMMANDS_KEY,e)}}t.CommandManager=c,c.COMMANDS_KEY="commandRunner.commands",c.SELECTED_PACKAGE_KEY="commandRunner.selectedPackageJson",c.PREFERENCES_KEY="commandRunner.preferences",c.PACKAGE_HISTORY_KEY="commandRunner.packageHistory",c.DEFAULT_PREFERENCES={autoSelectPackageJson:!0,rememberLastSelection:!0,showContextualSuggestions:!0,maxSearchDepth:5,preferWorkspaceRoots:!0}},842:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SmartDetectionService=void 0;const i=r(n(398)),c=r(n(928));t.SmartDetectionService=class{constructor(e){this.projectStructurePatterns=new Map,this.discoveryService=e,this.initializeProjectPatterns()}initializeProjectPatterns(){this.projectStructurePatterns=new Map([["react",["src","public","package.json","node_modules"]],["vue",["src","public","package.json","vue.config.js"]],["angular",["src","angular.json","package.json","node_modules"]],["next",["pages","package.json","next.config.js"]],["nuxt",["pages","package.json","nuxt.config.js"]],["express",["package.json","server.js","app.js"]],["nest",["src","package.json","nest-cli.json"]],["lerna",["lerna.json","package.json","packages"]],["nx",["nx.json","package.json","apps","libs"]],["rush",["rush.json","package.json","apps"]],["yarn-workspace",["package.json","yarn.lock","packages"]],["npm-workspace",["package.json","package-lock.json","packages"]]])}async analyzeProjectContext(e,t={}){const n={includeParentProjects:!0,prioritizeWorkspaceRoots:!0,detectMonorepos:!0,analyzeProjectStructure:!0,...t},a=await this.discoveryService.discoverPackageJsonFiles(e,{maxDepthUp:n.includeParentProjects?10:0,maxDepthDown:5}),o=this.discoveryService.getWorkspaceRoot(e)||e,s=this.filterRelevantPackageJsons(a,e,n),r=this.detectProjectType(s,o);return{type:r,rootPackageJson:this.findRootPackageJson(s,o,r),relevantPackageJsons:s,workspaceRoot:o,currentPath:e,recommendations:await this.generateRecommendations(s,e,r)}}filterRelevantPackageJsons(e,t,n){let a=[...e];return n.prioritizeWorkspaceRoots&&a.forEach(e=>{e.isWorkspaceRoot&&(e.score+=100)}),a=a.filter(e=>!!e.isWorkspaceRoot||e.distance<=3||!!e.isMonorepoRoot||!!(e.scripts&&Object.keys(e.scripts).length>=5)),a.sort((e,t)=>t.score-e.score),a}detectProjectType(e,t){return e.some(e=>e.isMonorepoRoot)?"monorepo":e.length>1?e.some(e=>e.isWorkspaceRoot)?"workspace":"nested":"single-package"}findRootPackageJson(e,t,n){if(0!==e.length){if("monorepo"===n){const t=e.find(e=>e.isMonorepoRoot);if(t)return t}if("workspace"===n){const t=e.find(e=>e.isWorkspaceRoot);if(t)return t}return e[0]}}async generateRecommendations(e,t,n){const a=[];if(0===e.length)return a.push("No package.json files found. Consider initializing a new npm project."),a;const o=await this.analyzeProjectStructure(t);switch(n){case"monorepo":a.push("Monorepo detected. Consider using workspace-specific commands."),e.length>3&&a.push("Multiple packages found. Use package selection for targeted operations.");break;case"workspace":a.push("VS Code workspace detected. Commands will be scoped to workspace boundaries.");break;case"nested":a.push("Nested package structure detected. Select the appropriate package.json for your task.");break;case"single-package":a.push("Single package project detected.")}const s=new Set;return e.forEach(e=>{e.scripts&&Object.keys(e.scripts).forEach(e=>s.add(e))}),(s.has("dev")||s.has("start"))&&a.push('Development scripts available. Use "dev" or "start" to run the project.'),s.has("build")&&a.push('Build script available. Use "build" for production builds.'),s.has("test")&&a.push('Test script available. Use "test" to run tests.'),o.includes("react")&&a.push("React project detected. Common commands: start, build, test."),o.includes("next")&&a.push("Next.js project detected. Common commands: dev, build, start."),a}async analyzeProjectStructure(e){const t=[];for(const[n,a]of this.projectStructurePatterns){let o=0;for(const t of a){const n=c.join(e,t);try{await i.workspace.fs.stat(i.Uri.file(n)),o++}catch{}}o>=Math.ceil(.6*a.length)&&t.push(n)}return t}async getContextualRecommendations(e){const t=await this.analyzeProjectContext(e);switch(t.type){case"monorepo":return t.relevantPackageJsons.slice(0,5);case"workspace":return t.relevantPackageJsons.filter(e=>e.isWorkspaceRoot||e.distance<=2);default:return t.relevantPackageJsons.slice(0,3)}}async shouldUseSpecificPackageJson(e){const t=await this.analyzeProjectContext(e);if(1===t.relevantPackageJsons.length)return t.relevantPackageJsons[0];if(t.relevantPackageJsons.length>1){const[e,n]=t.relevantPackageJsons;if(e.score>1.5*n.score)return e}return null}}},862:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewUtils=void 0;const i=r(n(928)),c=r(n(896));t.WebviewUtils=class{static getSharedCSS(e){try{if(e){const t=i.join(e.extensionPath,"media","webview-styles.css");if(c.existsSync(t))return c.readFileSync(t,"utf8")}}catch(e){console.warn("Could not load shared CSS file:",e)}return"\n            :root {\n                --spacing-xs: 4px;\n                --spacing-sm: 8px;\n                --spacing-md: 12px;\n                --spacing-lg: 16px;\n                --spacing-xl: 20px;\n                --spacing-2xl: 24px;\n                --spacing-3xl: 32px;\n                --radius-sm: 3px;\n                --radius-md: 4px;\n                --radius-lg: 6px;\n                --transition-fast: 0.15s ease-in-out;\n            }\n            \n            .webview-body {\n                font-family: var(--vscode-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif);\n                font-size: var(--vscode-font-size, 13px);\n                line-height: 1.5;\n                padding: var(--spacing-2xl);\n                margin: 0;\n                color: var(--vscode-foreground);\n                background-color: var(--vscode-editor-background);\n                min-height: 100vh;\n                box-sizing: border-box;\n            }\n            \n            .container { max-width: 800px; margin: 0 auto; }\n            .container-narrow { max-width: 480px; margin: 0 auto; }\n        "}static createWebviewHTML(e){const{title:t,content:n,additionalCSS:a="",additionalJS:o="",context:s}=e;return`\n            <!DOCTYPE html>\n            <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>${t}</title>\n                <style>\n                    ${this.getSharedCSS(s)}\n                    ${a}\n                </style>\n            </head>\n            <body class="webview-body">\n                ${n}\n                ${o?`<script>${o}<\/script>`:""}\n            </body>\n            </html>\n        `}static createFormWebview(e){const{title:t,subtitle:n,formId:a,fields:o,submitButtonText:s="Submit",showCancelButton:r=!0,onSubmitJS:i="",context:c}=e,d=`\n            <div class="container-narrow">\n                <div class="header">\n                    <h1 class="header-title">${t}</h1>\n                    ${n?`<p class="header-subtitle">${n}</p>`:""}\n                </div>\n                \n                <form id="${a}">\n                    ${o.map(e=>`\n            <div class="form-group">\n                <label for="${e.id}" class="form-label">\n                    ${e.label}\n                    ${e.description?`<div class="form-label-description">${e.description}</div>`:""}\n                </label>\n                <input \n                    type="${e.type||"text"}" \n                    id="${e.id}" \n                    name="${e.name}" \n                    class="form-input"\n                    ${e.placeholder?`placeholder="${e.placeholder}"`:""}\n                    ${e.required?"required":""}\n                >\n            </div>\n        `).join("")}\n                    \n                    <div class="button-container">\n                        ${r?'<button type="button" class="button button-secondary" onclick="window.close()">Cancel</button>':""}\n                        <button type="submit" class="button">${s}</button>\n                    </div>\n                </form>\n            </div>\n        `,l=`\n            const vscode = acquireVsCodeApi();\n            document.getElementById('${a}').addEventListener('submit', (e) => {\n                e.preventDefault();\n                const formData = new FormData(e.target);\n                const data = Object.fromEntries(formData.entries());\n                vscode.postMessage({\n                    command: 'formSubmit',\n                    formId: '${a}',\n                    data: data\n                });\n                ${i}\n            });\n        `;return this.createWebviewHTML({title:t,content:d,additionalJS:l,context:c})}static createInfoWebview(e){const{title:t,icon:n,sections:a,context:o}=e,s=`\n            <div class="container">\n                <div class="header">\n                    <h2 class="header-title">\n                        ${n?`<span style="margin-right: 8px;">${n}</span>`:""}\n                        ${t}\n                    </h2>\n                </div>\n                ${a.map(e=>`\n            <div class="section ${e.className||""}">\n                <h3 class="section-title">\n                    ${e.icon?`<span style="margin-right: 8px;">${e.icon}</span>`:""}\n                    ${e.title}\n                </h3>\n                ${e.content}\n            </div>\n        `).join("")}\n            </div>\n        `;return this.createWebviewHTML({title:t,content:s,context:o})}static createKeyValueGrid(e){return`\n            <div class="grid-2col">\n                ${e.map(e=>`\n                    <span class="text-label">${e.key}:</span>\n                    <span class="${e.valueClass||"code"}">${e.value}</span>\n                `).join("")}\n            </div>\n        `}static createEmptyState(e,t){return`\n            <div class="empty-state">\n                <span class="empty-state-icon">${e}</span>\n                ${t}\n            </div>\n        `}}},896:e=>{e.exports=require("fs")},928:e=>{e.exports=require("path")},944:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.CommandProvider=t.InfoTreeItem=t.PackageJsonInfoItem=t.CommandTreeItem=void 0;const i=r(n(398)),c=r(n(928));class d extends i.TreeItem{constructor(e,t,n,a,o){super(t,o),this.commandId=e,this.label=t,this.action=n,this.tooltip=a,this.collapsibleState=o,this.tooltip=`${a}\n\nCommand: ${n}`,this.description="",this.contextValue="commandItem",this.id=e,this.iconPath=this.getCommandIcon(n),this.command={command:"command-runner.runCommand",title:"Run Command",arguments:[this]}}getCommandIcon(e){const t=e.toLowerCase();return t.includes("start")||t.includes("serve")||t.includes("dev")?new i.ThemeIcon("play",new i.ThemeColor("charts.green")):t.includes("build")||t.includes("compile")?new i.ThemeIcon("tools",new i.ThemeColor("charts.blue")):t.includes("test")?new i.ThemeIcon("beaker",new i.ThemeColor("charts.purple")):t.includes("lint")||t.includes("format")?new i.ThemeIcon("check",new i.ThemeColor("charts.orange")):t.includes("deploy")||t.includes("publish")?new i.ThemeIcon("rocket",new i.ThemeColor("charts.red")):t.includes("install")||t.includes("add")?new i.ThemeIcon("package",new i.ThemeColor("charts.yellow")):new i.ThemeIcon("terminal",new i.ThemeColor("foreground"))}}t.CommandTreeItem=d;class l extends i.TreeItem{constructor(e,t,n){super(t,i.TreeItemCollapsibleState.None),this.packageJsonPath=e,this.packageName=t,this.packageDirectory=n,this.tooltip=`Current package.json: ${n}\n\nClick to view detailed information`,this.description=c.relative(i.workspace.workspaceFolders?.[0]?.uri.fsPath||"",n)||"./",this.contextValue="packageJsonInfo",this.iconPath=new i.ThemeIcon("package",new i.ThemeColor("charts.blue")),this.command={command:"command-runner.showPackageJsonInfo",title:"Show Package.json Info"}}}t.PackageJsonInfoItem=l;class u extends i.TreeItem{constructor(e,t,n,a,o){super(e,i.TreeItemCollapsibleState.None),this.contextValue=t,this.description=a,this.iconPath=o,n&&(this.command=n),"noPackageJson"===t?(this.iconPath=new i.ThemeIcon("warning",new i.ThemeColor("problemsWarningIcon.foreground")),this.tooltip="No package.json found in the current workspace. Click to select one manually."):"separator"===t?(this.iconPath=void 0,this.description=void 0):"suggestion"===t&&(this.iconPath=new i.ThemeIcon("lightbulb",new i.ThemeColor("editorLightBulb.foreground")))}}t.InfoTreeItem=u,t.CommandProvider=class{constructor(e){this._onDidChangeTreeData=new i.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.commandManager=e}refresh(){this._onDidChangeTreeData.fire()}getTreeItem(e){return e}async getChildren(e){if(e)return[];const t=[],n=this.commandManager.getCurrentPackageJson();n||(t.push(new u("No package.json found","noPackageJson",{command:"command-runner.selectPackageJson",title:"Select Package.json"},"Click to select manually")),t.push(new u("","separator")));const a=this.commandManager.getCommands(),o=a.map(e=>{const t=new d(e.id,e.name,e.action,e.summary,i.TreeItemCollapsibleState.None);if(e.packageJsonPath&&n?.path!==e.packageJsonPath){const n=t.tooltip||e.summary,a=` (Created for: ${c.basename(c.dirname(e.packageJsonPath))})`;return new d(e.id,e.name,e.action,n+a,i.TreeItemCollapsibleState.None)}return t});return t.push(...o),0===a.length&&n&&await this.addContextualSuggestions(t,n),t}async addContextualSuggestions(e,t){if(!t.scripts)return;const n=[],a=t.scripts,o=[{script:"start",description:"Start the application"},{script:"dev",description:"Start development server"},{script:"build",description:"Build for production"},{script:"test",description:"Run tests"},{script:"lint",description:"Run linter"}];for(const{script:e,description:t}of o)a[e]&&n.push({name:`npm run ${e}`,action:`npm run ${e}`,summary:t});if(n.length>0){e.push(new u("","separator")),e.push(new u("Suggested Commands","suggestionHeader",void 0,`${n.length} available`,new i.ThemeIcon("lightbulb",new i.ThemeColor("editorLightBulb.foreground"))));for(const t of n){const n=new u(t.name,"suggestion",{command:"command-runner.addSuggestedCommand",title:"Add Suggested Command",arguments:[t]},"Click to add",new i.ThemeIcon("add",new i.ThemeColor("charts.green")));n.tooltip=`${t.summary}\n\nClick to add this command to your list`,e.push(n)}}}}},955:function(e,t,n){var a,o=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(a=function(e){return a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},a(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=a(e),r=0;r<n.length;r++)"default"!==n[r]&&o(t,e,n[r]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.PackageJsonSelector=void 0;const i=r(n(398)),c=r(n(928)),d=n(862);class l{static async selectPackageJson(e,t,n={}){const a={...l.DEFAULT_OPTIONS,...n};if(0===e.length)return void i.window.showWarningMessage("No package.json files found.");if(1===e.length&&e[0].score>80)return a.allowMultiSelect?[e[0]]:e[0];const o=this.createQuickPickItems(e,t,a),s=i.window.createQuickPick();return s.title=a.title,s.placeholder=a.placeholder,s.items=o,s.canSelectMany=a.allowMultiSelect,s.matchOnDescription=!0,s.matchOnDetail=!0,t&&a.showProjectContext&&(s.title=`${a.title} - ${this.getProjectTypeLabel(t.type)}`),new Promise(e=>{s.onDidAccept(()=>{const t=s.selectedItems;t.length>0?a.allowMultiSelect?e(t.map(e=>e.packageInfo)):e(t[0].packageInfo):e(void 0),s.dispose()}),s.onDidHide(()=>{e(void 0),s.dispose()}),s.show()})}static createQuickPickItems(e,t,n){const a=[],o=n?.maxItems||10,s=e.slice(0,o);for(const e of s){const n=this.createQuickPickItem(e,t);a.push(n)}return a.sort((e,t)=>e.isRecommended&&!t.isRecommended?-1:!e.isRecommended&&t.isRecommended?1:t.packageInfo.score-e.packageInfo.score),a}static createQuickPickItem(e,t){this.getRelativePath(e.directory);const n=this.createLabel(e),a=this.createDescription(e),o=this.createDetail(e,t),s=t?.rootPackageJson?.path===e.path||e.isWorkspaceRoot||e.score>80;return{label:s?`$(star-full) ${n}`:n,description:a,detail:o,packageInfo:e,isRecommended:s}}static createLabel(e){return e.name?e.name:c.basename(e.directory)||"Unnamed Package"}static createDescription(e){const t=[];e.version&&t.push(`v${e.version}`),e.isWorkspaceRoot&&t.push("Workspace Root"),e.isMonorepoRoot&&t.push("Monorepo Root");const n=e.scripts?Object.keys(e.scripts).length:0;return n>0&&t.push(`${n} scripts`),t.join(" • ")}static createDetail(e,t){const n=[this.getRelativePath(e.directory)];if(e.distance>0&&n.push(`${e.distance} levels away`),e.scripts){const t=["start","dev","build","test","lint"].filter(t=>e.scripts[t]);t.length>0&&n.push(`Scripts: ${t.join(", ")}`)}return n.join(" • ")}static getRelativePath(e){const t=i.workspace.workspaceFolders;if(!t)return e;for(const n of t)if(e.startsWith(n.uri.fsPath))return c.relative(n.uri.fsPath,e)||"./";return e}static getProjectTypeLabel(e){switch(e){case"monorepo":return"Monorepo Project";case"workspace":return"VS Code Workspace";case"nested":return"Nested Project";case"single-package":return"Single Package";default:return"Project"}}static async showSimpleSelection(e,t="Select Package.json"){if(0===e.length)return;if(1===e.length)return e[0];const n=e.map(e=>({label:e.name||c.basename(e.directory),description:this.getRelativePath(e.directory),packageInfo:e})),a=await i.window.showQuickPick(n,{title:t,placeHolder:"Choose a package.json file"});return a?.packageInfo}static async confirmAutoSelection(e,t){const n=this.getRelativePath(e.directory),a=`Auto-selected "${e.name||c.basename(e.directory)}" at ${n}. ${t}`;return"Use This"===await i.window.showInformationMessage(a,{modal:!1},"Use This","Choose Different")}static async showPackageJsonInfo(e){i.window.createWebviewPanel("packageJsonInfo",`Package Info: ${e.name||"Unnamed"}`,i.ViewColumn.Beside,{enableScripts:!1}).webview.html=this.generatePackageInfoHtml(e)}static generatePackageInfoHtml(e){const t=this.getRelativePath(e.directory),n=e.scripts||{},a=Object.entries(n),o=[{key:"Location",value:t}];e.version&&o.push({key:"Version",value:e.version});const s=[...e.isWorkspaceRoot?['<span class="badge">Workspace Root</span>']:[],...e.isMonorepoRoot?['<span class="badge">Monorepo Root</span>']:[]].join(""),r=d.WebviewUtils.createKeyValueGrid([{key:"Distance",value:`${e.distance} levels`},{key:"Relevance Score",value:e.score.toFixed(2)}]),i=a.length>0?`<div class="grid-2col-start">\n                ${a.map(([e,t])=>`\n                    <div class="script-name">${e}</div>\n                    <div class="script-command">${t}</div>\n                `).join("")}\n            </div>`:d.WebviewUtils.createEmptyState("📝","No scripts available in this package.json"),c=[{title:"Properties",icon:"⚙️",content:`\n                    ${s?`<div class="mb-lg">${s}</div>`:""}\n                    ${r}\n                `},{title:"Scripts"+(a.length>0?` (${a.length})`:""),icon:"🔧",content:i}],l=`\n            <div class="container">\n                <div class="header">\n                    <h2 class="header-title">\n                        📦 ${e.name||"Unnamed Package"}\n                    </h2>\n                    <div class="header-info">\n                        ${o.map(e=>`\n                            <span class="text-label">${e.key}:</span>\n                            <span class="code">${e.value}</span>\n                        `).join("")}\n                    </div>\n                </div>\n                ${c.map(e=>`\n                    <div class="section">\n                        <h3 class="section-title">\n                            <span style="margin-right: 8px;">${e.icon}</span>\n                            ${e.title}\n                        </h3>\n                        ${e.content}\n                    </div>\n                `).join("")}\n            </div>\n        `;return d.WebviewUtils.createWebviewHTML({title:"Package Information",content:l,additionalCSS:"\n            .script-name {\n                font-family: var(--vscode-editor-font-family, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace);\n                color: var(--vscode-textLink-foreground, var(--vscode-button-background));\n                font-weight: 600;\n                font-size: 13px;\n                padding: 6px 8px;\n                background: var(--vscode-textCodeBlock-background, var(--vscode-editor-selectionBackground, rgba(128, 128, 128, 0.1)));\n                border-radius: 4px;\n                border-left: 3px solid var(--vscode-textLink-foreground, var(--vscode-button-background));\n            }\n\n            .script-command {\n                font-family: var(--vscode-editor-font-family, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace);\n                background: var(--vscode-textBlockQuote-background, var(--vscode-editor-background));\n                color: var(--vscode-foreground);\n                padding: 6px 8px;\n                border-radius: 4px;\n                border: 1px solid var(--vscode-panel-border, var(--vscode-widget-border, rgba(128, 128, 128, 0.35)));\n                font-size: 12px;\n                word-break: break-all;\n            }\n\n            .header-info {\n                display: grid;\n                grid-template-columns: auto 1fr;\n                gap: 16px 24px;\n                margin-top: 16px;\n            }\n\n            .header-info .text-label {\n                font-weight: 600;\n                color: var(--vscode-textPreformat-foreground, var(--vscode-foreground));\n                font-size: 13px;\n            }\n\n            .header-info .code {\n                color: var(--vscode-foreground);\n                font-family: var(--vscode-editor-font-family, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace);\n                font-size: 12px;\n                background: var(--vscode-textCodeBlock-background, var(--vscode-editor-selectionBackground, rgba(128, 128, 128, 0.1)));\n                padding: 2px 6px;\n                border-radius: 3px;\n                word-break: break-all;\n            }\n        "})}}t.PackageJsonSelector=l,l.DEFAULT_OPTIONS={showRecommended:!0,showProjectContext:!0,allowMultiSelect:!1,maxItems:10,title:"Select Package.json",placeholder:"Choose a package.json file to use"}}},t={},n=function n(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,n),s.exports}(265);module.exports=n})();
//# sourceMappingURL=extension.js.map